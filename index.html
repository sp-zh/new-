<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>书培 · 个人主页</title>
  <meta name="description" content="高级古风交互主页" />
  <style>
    :root{--ink:#0b0f14;--paper:#f7f4ef;--gold:#c5a572;--shadow:0 20px 60px rgba(0,0,0,.25);}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;overflow:hidden;color:#222;font-family:ui-serif,Georgia,"Songti SC",STSong,SimSun,serif;background:radial-gradient(1200px 800px at 70% 20%,#ffffff 0%,#f3efe8 60%,#e9e4da 100%);}

    .stage{position:fixed;inset:0;}
    canvas.bg{position:absolute;inset:0;width:100%;height:100%;display:block;}
    .shell{position:relative;z-index:5;display:grid;place-items:center;height:100%;padding:2rem;}
    .card{position:relative;backdrop-filter:blur(6px)saturate(110%);background:rgba(247,244,239,.82);border:1px solid rgba(197,165,114,.45);box-shadow:var(--shadow);width:min(760px,92vw);min-height:320px;padding:3.2rem 3rem;border-radius:18px;}
    .card:before,.card:after{content:"";position:absolute;width:64px;height:64px;border:2px solid var(--gold);opacity:.85;}
    .card:before{left:-10px;top:-10px;border-right:none;border-bottom:none;border-radius:12px 0 0 0;}
    .card:after{right:-10px;bottom:-10px;border-left:none;border-top:none;border-radius:0 0 12px 0;}
    .titlewrap{display:flex;justify-content:center;margin:0 0 .6rem}
    svg.title{width:min(680px,86vw);height:auto;overflow:visible}
    .stroke{fill:url(#goldGrad);stroke:url(#goldGrad);stroke-width:2.2;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:900;stroke-dashoffset:900;animation:draw 2.8s ease forwards .3s,glow 4s ease-in-out infinite 3.2s;}
    @keyframes draw{to{stroke-dashoffset:0}}
    @keyframes glow{0%,100%{filter:drop-shadow(0 2px 0 rgba(255,255,255,.6))drop-shadow(0 10px 24px rgba(0,0,0,.22));}50%{filter:drop-shadow(0 2px 0 rgba(255,255,255,.9))drop-shadow(0 16px 34px rgba(0,0,0,.28));}}
    .subtitle{margin:.2rem 0 1.6rem;text-align:center;font-size:15px;letter-spacing:.38em;color:#5f5a52;}
    .divider{height:1px;background:linear-gradient(90deg,rgba(197,165,114,0)0%,rgba(197,165,114,.9)50%,rgba(197,165,114,0)100%);margin:1.2rem auto 1.8rem;width:62%;}
    .contact{display:flex;gap:1.2rem;justify-content:center;flex-wrap:wrap;}
    .tag{display:inline-flex;align-items:center;gap:.6rem;padding:.6rem .9rem;border:1px solid rgba(197,165,114,.65);color:#2a2a2a;background:linear-gradient(180deg,rgba(255,255,255,.8),rgba(245,241,235,.7));border-radius:999px;transition:transform .25s ease,box-shadow .25s ease;cursor:pointer;text-decoration:none}
    .tag:hover{transform:translateY(-2px);box-shadow:0 10px 24px rgba(0,0,0,.12)}
    .tag svg{width:18px;height:18px;}
    .seal{position:fixed;right:24px;bottom:20px;z-index:6;font-family:"Songti SC",STSong,SimSun,serif;}
    .chop{display:inline-block;padding:.35rem .5rem;border:2px solid #b22;color:#b22;transform:rotate(-4deg);letter-spacing:.35em;background:rgba(255,255,255,.88);text-decoration:none;cursor:pointer;}
    .chop:hover{background:#b22;color:#fff;}
    /* 弹窗 */
    .ipPopup{position:fixed;right:24px;bottom:74px;z-index:8;max-width:320px;padding:12px 14px;border-radius:12px;border:1px solid rgba(197,165,114,.6);background:rgba(247,244,239,.95);backdrop-filter:blur(6px);box-shadow:0 16px 40px rgba(0,0,0,.22);color:#2a2a2a;font-size:14px;line-height:1.45;display:none;}
    .ipPopup.show{display:block}
    .ipPopup .addr{font-weight:600}
    .ipPopup .meta{opacity:.75;font-size:12px;margin-top:6px}
  </style>
</head>
<body>
  <div class="stage">
    <canvas id="ink" class="bg"></canvas>
    <canvas id="brush" class="bg" style="pointer-events:none"></canvas>
  </div>

  <div class="shell">
    <div class="card">
      <div class="titlewrap">
        <svg class="title" viewBox="0 0 800 130">
          <defs>
            <linearGradient id="goldGrad" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#d7b86f"/>
              <stop offset="50%" stop-color="#fff3c4"/>
              <stop offset="100%" stop-color="#d7b86f"/>
            </linearGradient>
          </defs>
          <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="64" class="stroke">Shupei Zhang</text>
        </svg>
      </div>
      <p class="subtitle" id="date"></p>
      <div class="divider"></div>
      <div class="contact">
        <a class="tag" href="mailto:spzhang18@aliyun.com">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M4 6h16a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z"/><path d="m22 8-10 6L2 8"/></svg>
          <span>spzhang18@aliyun.com</span>
        </a>
      </div>
    </div>
  </div>

  <div class="seal">
    <a id="ipBtn" class="chop" href="#">sp</a>
  </div>
  <div id="ipPopup" class="ipPopup">
    <div id="ipText">正在获取 IP 与位置…</div>
    <div class="meta" id="ipMeta"></div>
  </div>

  <script>
    // 显示当前日期
    (function(){
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, '0');
      const dd = String(today.getDate()).padStart(2, '0');
      document.getElementById("date").textContent = `${yyyy}-${mm}-${dd}`;
    })();

    // 点击 sp 显示 IP 与位置
    (function(){
      const btn=document.getElementById('ipBtn');
      const pop=document.getElementById('ipPopup');
      const text=document.getElementById('ipText');
      const meta=document.getElementById('ipMeta');
      let open=false;

      async function getIP(){
        try{const r=await fetch('https://api.ipify.org?format=json');const j=await r.json();return j.ip;}
        catch{const r2=await fetch('https://ipwho.is/');const j2=await r2.json();return j2.ip||'未知';}
      }
      async function getGeo(){
        try{const r=await fetch('https://ipapi.co/json/');const j=await r.json();return {city:j.city,region:j.region,country:j.country_name,lat:j.latitude,lon:j.longitude,org:j.org||''};}
        catch{const r2=await fetch('https://ipwho.is/');const j2=await r2.json();return {city:j2.city,region:j2.region,country:j2.country,lat:j2.latitude,lon:j2.longitude,org:(j2.connection&&j2.connection.org)||''};}
      }
      function now(){const d=new Date();return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')} ${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}`;}

      async function show(){
        pop.classList.add('show'); open=true;
        text.textContent='正在获取 IP 与位置…'; meta.textContent='';
        try{
          const [ip,geo]=await Promise.all([getIP(),getGeo()]);
          const addr=[geo.city,geo.region,geo.country].filter(Boolean).join(' · ');
          const coord=(geo.lat&&geo.lon)?`${geo.lat.toFixed(4)}, ${geo.lon.toFixed(4)}`:'';
          text.innerHTML=`IP：<span class="addr">${ip}</span><br>位置：<span class="addr">${addr||'未知'}</span>`;
          meta.textContent=`时间：${now()}${coord?' · 坐标：'+coord:''}${geo.org?' · 运营商：'+geo.org:''}`;
        }catch{ text.textContent='获取失败（可能被浏览器或网络拦截）。'; }
      }

      btn.addEventListener('click',e=>{
        e.preventDefault();
        if(!open) show(); else { pop.classList.remove('show'); open=false; }
      });
    })();
  </script>
</body>
</html>
